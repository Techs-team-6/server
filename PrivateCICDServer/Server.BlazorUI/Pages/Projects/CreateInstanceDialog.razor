@using Server.BlazorUI.Components
@using Microsoft.AspNetCore.Components
@using Server.API.Client.Contracts
@using System.Globalization
<Dialog Size="@DialogSize.Normal" Centered="true" IsShowing="_isShown" Animation="@DialogAnimation.SlideDown">
    <DialogHeader>
        <h4>Create new instance</h4>
    </DialogHeader>
    <DialogBody>
        <OurForm>
            <OurInput Label="Start string" @bind-Value="_startString"/>
            <OurInput Label="Build id" @bind-Value="_buildId"/>
            <OurInput Label="Build id" @bind-Value="_machineId"/>
        </OurForm>
    </DialogBody>
    <DialogFooter>
        <button type="button" class="btn btn-primary" @onclick="@Approve">Create</button>
        <button type="button" class="btn btn-secondary" @onclick="@Cancel">Cancel</button>
    </DialogFooter>
</Dialog>

@code
{
    private string _startString { get; set; }
    private string _buildId { get; set; }
    private Guid _projectId { get; set; }
    private string _machineId { get; set; }
    private bool _isShown;
    
    [Parameter]
    public Action<Guid, string, Guid, Guid> OnInstanceCreate { get; set; }

    public void Show(Guid projectId)
    {
        _isShown = true;
        _projectId = projectId;
    }

    private void Approve()
    {
        _isShown = false;
        var buildId = Guid.Parse(_buildId);
        var machineId = Guid.Parse(_machineId);
        OnInstanceCreate.Invoke(_projectId, _startString, buildId, machineId);
    }
    
    private void Cancel()
    {
        _isShown = false;
    }
}